{"ast":null,"code":"import{json,useRouteLoaderData,redirect,defer,Await}from\"react-router-dom\";import EventItem from\"../components/EventItem\";import EventsList from\"../components/EventsList\";import{Suspense}from\"react\";import{getAuthToken}from\"../util/auth\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";export default function EventDetailPage(){const{event,events}=useRouteLoaderData(\"event-detail\");return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"p\",{style:{textAlign:\"center\"},children:\"\\uB85C\\uB529\\uC911...\"}),children:/*#__PURE__*/_jsx(Await,{resolve:event,children:loadedevent=>/*#__PURE__*/_jsx(EventItem,{event:loadedevent})})}),/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"p\",{style:{textAlign:\"center\"},children:\"\\uB85C\\uB529\\uC911...\"}),children:/*#__PURE__*/_jsx(Await,{resolve:events,children:loadedEvents=>/*#__PURE__*/_jsx(EventsList,{events:loadedEvents})})})]});}async function loadEvent(id){const response=await fetch(`http://localhost:8080/events/${id}`);if(!response.ok){throw json({message:\"선택된 이벤트의 세부정보를 가져올 수 없습니다.\"},{status:500});}else{const resData=await response.json();return resData.event;}}async function loadEvents(){const response=await fetch(\"http://localhost:8080/events\");if(!response.ok){return json({message:\"이벤트를 가져올 수 없습니다.\"},{status:500});}else{const resData=await response.json();return resData.events;}}export async function loader(_ref){let{request,params}=_ref;const id=params.eventId;return defer({event:await loadEvent(id),events:loadEvents()});}export async function action(_ref2){let{params,request}=_ref2;const eventId=params.eventId;const token=getAuthToken();const response=await fetch(`http://localhost:8080/events/${eventId}`,{method:request.method,headers:{Authorization:\"Bearer \"+token}});if(!response.ok){throw json({message:\"이벤트를 삭제할 수 없습니다.\"},{status:500});}return redirect(\"/events\");}","map":{"version":3,"names":["json","useRouteLoaderData","redirect","defer","Await","EventItem","EventsList","Suspense","getAuthToken","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","EventDetailPage","event","events","children","fallback","style","textAlign","resolve","loadedevent","loadedEvents","loadEvent","id","response","fetch","ok","message","status","resData","loadEvents","loader","_ref","request","params","eventId","action","_ref2","token","method","headers","Authorization"],"sources":["/Users/baekjaein/git-repo/nextjs/20-react-router-spa-2/frontend/src/pages/EventDetail.js"],"sourcesContent":["import {\n  json,\n  useRouteLoaderData,\n  redirect,\n  defer,\n  Await,\n} from \"react-router-dom\";\nimport EventItem from \"../components/EventItem\";\nimport EventsList from \"../components/EventsList\";\nimport { Suspense } from \"react\";\nimport { getAuthToken } from \"../util/auth\";\n\nexport default function EventDetailPage() {\n  const { event, events } = useRouteLoaderData(\"event-detail\");\n  return (\n    <>\n      <Suspense fallback={<p style={{ textAlign: \"center\" }}>로딩중...</p>}>\n        <Await resolve={event}>\n          {(loadedevent) => <EventItem event={loadedevent} />}\n        </Await>\n      </Suspense>\n      <Suspense fallback={<p style={{ textAlign: \"center\" }}>로딩중...</p>}>\n        <Await resolve={events}>\n          {(loadedEvents) => <EventsList events={loadedEvents} />}\n        </Await>\n      </Suspense>\n    </>\n  );\n}\n\nasync function loadEvent(id) {\n  const response = await fetch(`http://localhost:8080/events/${id}`);\n\n  if (!response.ok) {\n    throw json(\n      { message: \"선택된 이벤트의 세부정보를 가져올 수 없습니다.\" },\n      { status: 500 }\n    );\n  } else {\n    const resData = await response.json();\n    return resData.event;\n  }\n}\n\nasync function loadEvents() {\n  const response = await fetch(\"http://localhost:8080/events\");\n  if (!response.ok) {\n    return json(\n      { message: \"이벤트를 가져올 수 없습니다.\" },\n      {\n        status: 500,\n      }\n    );\n  } else {\n    const resData = await response.json();\n    return resData.events;\n  }\n}\n\nexport async function loader({ request, params }) {\n  const id = params.eventId;\n  return defer({\n    event: await loadEvent(id),\n    events: loadEvents(),\n  });\n}\n\nexport async function action({ params, request }) {\n  const eventId = params.eventId;\n  const token = getAuthToken();\n  const response = await fetch(`http://localhost:8080/events/${eventId}`, {\n    method: request.method,\n    headers: {\n      Authorization: \"Bearer \" + token,\n    },\n  });\n\n  if (!response.ok) {\n    throw json({ message: \"이벤트를 삭제할 수 없습니다.\" }, { status: 500 });\n  }\n\n  return redirect(\"/events\");\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}