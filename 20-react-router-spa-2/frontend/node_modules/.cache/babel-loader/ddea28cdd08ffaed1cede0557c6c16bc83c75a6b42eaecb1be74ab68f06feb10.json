{"ast":null,"code":"import{Form,useActionData,useNavigate,useNavigation,json,redirect}from\"react-router-dom\";import classes from\"./EventForm.module.css\";import{getAuthToken}from\"../util/auth\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function EventForm(_ref){let{method,event}=_ref;const data=useActionData();const navigate=useNavigate();const navigation=useNavigation();const isSubmitting=navigation.state===\"submitting\";function cancelHandler(){navigate(\"..\");}return/*#__PURE__*/_jsxs(Form,{method:method,className:classes.form,children:[data&&data.errors&&/*#__PURE__*/_jsx(\"ul\",{children:Object.values(data.errors).map(err=>/*#__PURE__*/_jsx(\"li\",{children:err},err))}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"title\",children:\"\\uC81C\\uBAA9\"}),/*#__PURE__*/_jsx(\"input\",{id:\"title\",type:\"text\",name:\"title\",required:true,defaultValue:event?event.title:\"\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"image\",children:\"\\uC0AC\\uC9C4\"}),/*#__PURE__*/_jsx(\"input\",{id:\"image\",type:\"url\",name:\"image\",required:true,defaultValue:event?event.image:\"\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"date\",children:\"\\uB0A0\\uC9DC\"}),/*#__PURE__*/_jsx(\"input\",{id:\"date\",type:\"date\",name:\"date\",required:true,defaultValue:event?event.date:\"\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"description\",children:\"\\uB0B4\\uC6A9\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"description\",name:\"description\",rows:\"5\",required:true,defaultValue:event?event.description:\"\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.actions,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:cancelHandler,disabled:isSubmitting,children:\"\\uCDE8\\uC18C\"}),/*#__PURE__*/_jsx(\"button\",{disabled:isSubmitting,children:isSubmitting?\"제출 중...\":\"저장\"})]})]});}export default EventForm;export async function action(_ref2){let{request,params}=_ref2;const method=request.method;const data=await request.formData();const eventData={title:data.get(\"title\"),image:data.get(\"image\"),date:data.get(\"date\"),description:data.get(\"description\")};let url=\"http://localhost:8080/events\";if(method===\"PATCH\"){const eventId=params.eventId;url=\"http://localhost:8080/events/\"+eventId;}const token=getAuthToken();const response=await fetch(url,{method:method,headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+token},body:JSON.stringify(eventData)});if(response.status===422){return response;}if(!response.ok){throw json({message:\"이벤트를 저장할 수 없습니다.\"},{status:500});}return redirect(\"/events\");}","map":{"version":3,"names":["Form","useActionData","useNavigate","useNavigation","json","redirect","classes","getAuthToken","jsx","_jsx","jsxs","_jsxs","EventForm","_ref","method","event","data","navigate","navigation","isSubmitting","state","cancelHandler","className","form","children","errors","Object","values","map","err","htmlFor","id","type","name","required","defaultValue","title","image","date","rows","description","actions","onClick","disabled","action","_ref2","request","params","formData","eventData","get","url","eventId","token","response","fetch","headers","Authorization","body","JSON","stringify","status","ok","message"],"sources":["/Users/baekjaein/git-repo/nextjs/20-react-router-spa-2/frontend/src/components/EventForm.js"],"sourcesContent":["import {\n  Form,\n  useActionData,\n  useNavigate,\n  useNavigation,\n  json,\n  redirect,\n} from \"react-router-dom\";\n\nimport classes from \"./EventForm.module.css\";\nimport { getAuthToken } from \"../util/auth\";\n\nfunction EventForm({ method, event }) {\n  const data = useActionData();\n  const navigate = useNavigate();\n  const navigation = useNavigation();\n\n  const isSubmitting = navigation.state === \"submitting\";\n\n  function cancelHandler() {\n    navigate(\"..\");\n  }\n\n  return (\n    <Form method={method} className={classes.form}>\n      {data && data.errors && (\n        <ul>\n          {Object.values(data.errors).map((err) => (\n            <li key={err}>{err}</li>\n          ))}\n        </ul>\n      )}\n      <p>\n        <label htmlFor=\"title\">제목</label>\n        <input\n          id=\"title\"\n          type=\"text\"\n          name=\"title\"\n          required\n          defaultValue={event ? event.title : \"\"}\n        />\n      </p>\n      <p>\n        <label htmlFor=\"image\">사진</label>\n        <input\n          id=\"image\"\n          type=\"url\"\n          name=\"image\"\n          required\n          defaultValue={event ? event.image : \"\"}\n        />\n      </p>\n      <p>\n        <label htmlFor=\"date\">날짜</label>\n        <input\n          id=\"date\"\n          type=\"date\"\n          name=\"date\"\n          required\n          defaultValue={event ? event.date : \"\"}\n        />\n      </p>\n      <p>\n        <label htmlFor=\"description\">내용</label>\n        <textarea\n          id=\"description\"\n          name=\"description\"\n          rows=\"5\"\n          required\n          defaultValue={event ? event.description : \"\"}\n        />\n      </p>\n      <div className={classes.actions}>\n        <button type=\"button\" onClick={cancelHandler} disabled={isSubmitting}>\n          취소\n        </button>\n        <button disabled={isSubmitting}>\n          {isSubmitting ? \"제출 중...\" : \"저장\"}\n        </button>\n      </div>\n    </Form>\n  );\n}\n\nexport default EventForm;\n\nexport async function action({ request, params }) {\n  const method = request.method;\n  const data = await request.formData();\n\n  const eventData = {\n    title: data.get(\"title\"),\n    image: data.get(\"image\"),\n    date: data.get(\"date\"),\n    description: data.get(\"description\"),\n  };\n\n  let url = \"http://localhost:8080/events\";\n\n  if (method === \"PATCH\") {\n    const eventId = params.eventId;\n    url = \"http://localhost:8080/events/\" + eventId;\n  }\n\n  const token = getAuthToken();\n  const response = await fetch(url, {\n    method: method,\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + token,\n    },\n    body: JSON.stringify(eventData),\n  });\n\n  if (response.status === 422) {\n    return response;\n  }\n\n  if (!response.ok) {\n    throw json({ message: \"이벤트를 저장할 수 없습니다.\" }, { status: 500 });\n  }\n\n  return redirect(\"/events\");\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}